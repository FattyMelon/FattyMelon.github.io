
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Simon&#39; Blog">
    <title>smallpt详解(一) - Simon&#39; Blog</title>
    <meta name="author" content="Simon chen">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="本文主要是为了记录我学习smallpt的过程。第一部分是关于整个程序的大致分解。第二部分主要说一下我对main函数中cx和cy的理解。第三部分主要说明光线跟踪的每一行代码所用到的数学知识。">
<meta property="og:type" content="blog">
<meta property="og:title" content="smallpt详解(一)">
<meta property="og:url" content="https://fattymelon.github.io/2017/04/20/raytracing1/index.html">
<meta property="og:site_name" content="Simon&#39; Blog">
<meta property="og:description" content="本文主要是为了记录我学习smallpt的过程。第一部分是关于整个程序的大致分解。第二部分主要说一下我对main函数中cx和cy的理解。第三部分主要说明光线跟踪的每一行代码所用到的数学知识。">
<meta property="og:image" content="http://img.blog.csdn.net/20170408164053927?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTM4MDg4MDMwNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170408170258582?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTM4MDg4MDMwNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:updated_time" content="2017-05-25T06:55:42.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallpt详解(一)">
<meta name="twitter:description" content="本文主要是为了记录我学习smallpt的过程。第一部分是关于整个程序的大致分解。第二部分主要说一下我对main函数中cx和cy的理解。第三部分主要说明光线跟踪的每一行代码所用到的数学知识。">
<meta name="twitter:image" content="http://img.blog.csdn.net/20170408164053927?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTM4MDg4MDMwNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
    
    
        
    
    
        <meta property="og:image" content="https://fattymelon.github.io/assets/images/me.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-sxklfps8ywgfyyjcowvnb4gxdgt0zjts3hsguljmv9uqanxjbnitrovtbrek.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Simon&#39; Blog</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/me.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/me.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Simon chen</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Good good study, day day up.  :D </p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/FattyMelon" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            smallpt详解(一)
        </h1>
    
    
        <div class="post-meta">
    <time itemprop="datePublished" datetime="2017-04-20T14:26:55+08:00">
	
		    Apr 20, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/光线跟踪/">光线跟踪</a>


    
</div>

    
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>本文主要是为了记录我学习smallpt的过程。第一部分是关于整个程序的大致分解。第二部分主要说一下我对main函数中cx和cy的理解。第三部分主要说明光线跟踪的每一行代码所用到的数学知识。<br><a id="more"></a></p>
<h2 id="1-基本功能函数"><a href="#1-基本功能函数" class="headerlink" title="1. 基本功能函数"></a>1. 基本功能函数</h2><h3 id="1-1-随机函数"><a href="#1-1-随机函数" class="headerlink" title="1.1 随机函数"></a>1.1 随机函数</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M_PI 3.1415</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">erand48</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> xsubi[<span class="number">3</span>])</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>)rand() / (<span class="keyword">double</span>)RAND_MAX;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>erand48()函数是linux下的随机函数，可以取[0, 1]的随机浮点数，在windows下必须自己写一个类似功能的函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">clamp</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? <span class="number">0</span> : x &gt; <span class="number">1</span> ? <span class="number">1</span> : x; &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">toInt</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">int</span>(<span class="built_in">pow</span>(clamp(x), <span class="number">1</span> / <span class="number">2.2</span>) * <span class="number">255</span> + <span class="number">.5</span>); &#125;    <span class="comment">//四舍五入</span></div></pre></td></tr></table></figure>
<p>这里的难点在于为什么要用pow(clamp(x), 1/ 2.2)，查了资料才知道是gamma校正方法，详情可以看<br><a href="http://blog.csdn.net/candycat1992/article/details/46228771" target="_blank" rel="external">http://blog.csdn.net/candycat1992/article/details/46228771</a></p>
<h3 id="1-2-Vec类"><a href="#1-2-Vec类" class="headerlink" title="1.2 Vec类"></a>1.2 Vec类</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Vec</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">double</span> x, y, z;</div><div class="line">    Vec(<span class="keyword">double</span> x_ = <span class="number">0</span>, <span class="keyword">double</span> y_ = <span class="number">0</span>, <span class="keyword">double</span> z_ = <span class="number">0</span>) : x(x_), y(y_), z(z_) &#123;&#125;</div><div class="line">    Vec <span class="keyword">operator</span>+(<span class="keyword">const</span> Vec&amp; rhs) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Vec(x + rhs.x, y + rhs.y, z + rhs.z);</div><div class="line">    &#125;</div><div class="line">    Vec <span class="keyword">operator</span>-(<span class="keyword">const</span> Vec&amp; rhs) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Vec(x - rhs.x, y - rhs.y, z - rhs.z);</div><div class="line">    &#125;</div><div class="line">    Vec <span class="keyword">operator</span>*(<span class="keyword">double</span> b) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Vec(x * b, y * b, z * b);</div><div class="line">    &#125;</div><div class="line">    <span class="function">Vec <span class="title">mult</span><span class="params">(<span class="keyword">const</span> Vec &amp;rhs)</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Vec(x * rhs.x, y * rhs.y, z * rhs.z);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(<span class="keyword">const</span> Vec &amp;rhs)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> x*rhs.x + y*rhs.y + z*rhs.z; &#125;</div><div class="line">    <span class="function">Vec <span class="title">cross</span><span class="params">(<span class="keyword">const</span> Vec &amp;rhs)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Vec(y * rhs.z - z * rhs.y,</div><div class="line">            z * rhs.x - x * rhs.z,</div><div class="line">            x * rhs.y - y * rhs.x);</div><div class="line">    &#125;</div><div class="line">    <span class="function">Vec&amp; <span class="title">norm</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * (<span class="number">1</span> / <span class="built_in">sqrt</span>(x*x + y*y + z*z)); &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>1) 其中包括向量加减，数乘，标准化，点乘，叉乘，还有需要注意的mult函数，后来会提到。<br>2) 这个Vec类在之后的计算中既可以表达向量Vector，亦可以表达三维点Point，也用来保存颜色RGB的值。</p>
<h3 id="1-3-Ray类"><a href="#1-3-Ray类" class="headerlink" title="1.3 Ray类"></a>1.3 Ray类</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ray</span> </span></div><div class="line">&#123;</div><div class="line">    Vec o, d;    <span class="comment">// o is original point, d is direction of lighting</span></div><div class="line">    Ray(Vec o_, Vec d_) : o(o_), d(d_) &#123;&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>射线方程，o是射线的起点，d代表方向</p>
<h3 id="1-4-Sphere类"><a href="#1-4-Sphere类" class="headerlink" title="1.4 Sphere类"></a>1.4 Sphere类</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">enum</span> Refl_t &#123; DIFF, SPEC, REFR&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sphere</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">double</span> rad;    <span class="comment">// radius</span></div><div class="line">    Vec position, emission, color;</div><div class="line">    Refl_t refl;</div><div class="line">    </div><div class="line">    Sphere(<span class="keyword">double</span> rad_, Vec p_, Vec e_, Vec c_, Refl_t refl_) :</div><div class="line">        rad(rad_), position(p_), emission(e_), color(c_), refl(refl_) &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">intersect</span><span class="params">(<span class="keyword">const</span> Ray &amp;r)</span> <span class="keyword">const</span> </span>&#123;    <span class="comment">// return distance, 0 if nohit</span></div><div class="line">        Vec op = position - r.o;</div><div class="line">        <span class="keyword">double</span> t, eps = <span class="number">1e-4</span>;</div><div class="line">        <span class="keyword">double</span> b = op.dot(r.d), det = b*b + rad*rad - op.dot(op);</div><div class="line">        <span class="keyword">if</span> (det &lt; <span class="number">0</span>)    </div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">else</span>    </div><div class="line">            det = <span class="built_in">sqrt</span>(det);</div><div class="line">        <span class="keyword">return</span> (t = b - det) &gt; eps ? t : ((t = b + det) &gt; eps ? t : <span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>射线和球体/圆，求交原理图：</p>
<p><img src="http://img.blog.csdn.net/20170408164053927?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTM4MDg4MDMwNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>求交的基本原理就是将射线的参数方程代入到圆的函数中，求t的值。<br>1）将P(t) = O + tD 代入圆方程，会得到 t 的一元二次方程。<br>2）先求出Vec op，op是用球心p的坐标减去射线的起点，表示原理图中的(O - C)。<br>3）b = op.dot(r.d)指代 “ D * (O - C) “<br>4）求det，这里要注意我们求的b和原理图中的b差了两倍，所以可以直接用<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">double</span> det = b * b - op.dot(op) + rad * rad;</div></pre></td></tr></table></figure></p>
<p>如果det&lt;0说明无解，直接return 0。<br>否则求根号的det<br>5）最终的解有一个或两个，可能在 t = b - det，或者t = b + det中，选择t大于0并且两个中较小的t。</p>
<hr>
<p><img src="http://img.blog.csdn.net/20170408170258582?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTM4MDg4MDMwNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="2-绘制过程"><a href="#2-绘制过程" class="headerlink" title="2. 绘制过程"></a>2. 绘制过程</h2><h3 id="2-1-放置球的位置"><a href="#2-1-放置球的位置" class="headerlink" title="2.1 放置球的位置"></a>2.1 放置球的位置</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Sphere spheres[] = &#123;</div><div class="line">    Sphere(<span class="number">1e5</span>, Vec(<span class="number">1e5</span> + <span class="number">1</span>, <span class="number">40.8</span>, <span class="number">81.6</span>), Vec(), Vec(<span class="number">.75</span>, <span class="number">.25</span>, <span class="number">.25</span>), Refl_t::DIFF),    <span class="comment">//left</span></div><div class="line">    Sphere(<span class="number">1e5</span>, Vec(<span class="number">-1e5</span> + <span class="number">99</span>,<span class="number">40.8</span>,<span class="number">81.6</span>),Vec(),Vec(<span class="number">.25</span>,<span class="number">.25</span>,<span class="number">.75</span>), Refl_t::DIFF),<span class="comment">//Rght </span></div><div class="line">    Sphere(<span class="number">1e5</span>, Vec(<span class="number">50</span>,<span class="number">40.8</span>, <span class="number">1e5</span>),     Vec(),Vec(<span class="number">.75</span>,<span class="number">.75</span>,<span class="number">.75</span>), Refl_t::DIFF),<span class="comment">//Back </span></div><div class="line">    Sphere(<span class="number">1e5</span>, Vec(<span class="number">50</span>,<span class="number">40.8</span>,<span class="number">-1e5</span> + <span class="number">170</span>), Vec(),Vec(),           Refl_t::DIFF),<span class="comment">//Frnt </span></div><div class="line">    Sphere(<span class="number">1e5</span>, Vec(<span class="number">50</span>, <span class="number">1e5</span>, <span class="number">81.6</span>),    Vec(),Vec(<span class="number">.75</span>,<span class="number">.75</span>,<span class="number">.75</span>),Refl_t::DIFF),<span class="comment">//Botm </span></div><div class="line">    Sphere(<span class="number">1e5</span>, Vec(<span class="number">50</span>,<span class="number">-1e5</span> + <span class="number">81.6</span>,<span class="number">81.6</span>),Vec(),Vec(<span class="number">.75</span>,<span class="number">.75</span>,<span class="number">.75</span>),Refl_t::DIFF),<span class="comment">//Top </span></div><div class="line">    Sphere(<span class="number">16.5</span>,Vec(<span class="number">27</span>,<span class="number">16.5</span>,<span class="number">47</span>),       Vec(),Vec(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)*<span class="number">.999</span>, Refl_t::SPEC),<span class="comment">//Mirr </span></div><div class="line">    Sphere(<span class="number">16.5</span>,Vec(<span class="number">73</span>,<span class="number">16.5</span>,<span class="number">78</span>),       Vec(),Vec(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)*<span class="number">.999</span>, Refl_t::REFR),<span class="comment">//Glas </span></div><div class="line">    Sphere(<span class="number">600</span>, Vec(<span class="number">50</span>,<span class="number">681.6</span> - <span class="number">.27</span>,<span class="number">81.6</span>),Vec(<span class="number">12</span>,<span class="number">12</span>,<span class="number">12</span>),  Vec(), Refl_t::DIFF) <span class="comment">//Lite </span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>1）用6个很大的球体当做平面（DIFF属性，只有漫反射），因为半径很大的话，你在近距离看起来，球面就很像一个平面。<br>作者这样做应该是为了避免去写平面求交，平面类等函数。<br>2）用1个球表示光源，就是Lite，1个Mirr球（完全反射），1个Glass球（折射和反射都有）</p>
<h3 id="2-2-遍历所有的球，求交点"><a href="#2-2-遍历所有的球，求交点" class="headerlink" title="2.2 遍历所有的球，求交点"></a>2.2 遍历所有的球，求交点</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">intersect</span><span class="params">(<span class="keyword">const</span> Ray &amp;r, <span class="keyword">double</span> &amp;t, <span class="keyword">int</span> &amp;id)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> n = <span class="keyword">sizeof</span>(spheres) / <span class="keyword">sizeof</span>(Sphere), d, inf = t = <span class="number">1e20</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="keyword">int</span>(n); i--;) &#123;</div><div class="line">        <span class="keyword">if</span> ((d = spheres[i].intersect(r)) &amp;&amp; d &lt; t) </div><div class="line">        &#123;</div><div class="line">            t = d;</div><div class="line">            id = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> t &lt; inf;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此光线射出去，在所有的球体中求交点。<br>求出距离camera最近的交点，这就是待会要绘制在屏幕上的主要的点。</p>
<h3 id="2-3-main函数"><a href="#2-3-main函数" class="headerlink" title="2.3 main函数"></a>2.3 main函数</h3><p>1）camera的位置是在（50， 52， 295.6）， 往z轴的负方向看。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">int main(int argc, char *argv[])</div><div class="line">&#123;</div><div class="line">    int w = 1024, h = 768, samps = argc == 2 ? atoi(argv[1]) / 4 : 10; // # samples </div><div class="line">    Ray cam(Vec(50, 52, 295.6), Vec(0, -0.042612, -1).norm()); // cam pos, dir </div><div class="line">    Vec cx = Vec(w*.5135 / h), cy = (cx.cross(cam.d)).norm()*.5135, r, *c = new Vec[w*h];</div><div class="line">    // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2）遍历每个像素点，用随机采样的方式求得要射出的光线的方向d。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y&lt;h; y++) &#123;                       <span class="comment">// Loop over image rows</span></div><div class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"\rRendering (%d spp) %5.2f%%"</span>, samps * <span class="number">4</span>, <span class="number">100.</span>*y / (h - <span class="number">1</span>));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">short</span> x = <span class="number">0</span>, Xi[<span class="number">3</span>] = &#123; <span class="number">0</span>,<span class="number">0</span>,y*y*y &#125;; x&lt;w; x++)   <span class="comment">// Loop cols </span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> sy = <span class="number">0</span>, i = (h - y - <span class="number">1</span>)*w + x; sy&lt;<span class="number">2</span>; sy++)     <span class="comment">// 2x2 subpixel rows </span></div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> sx = <span class="number">0</span>; sx&lt;<span class="number">2</span>; sx++, r = Vec()) &#123;        <span class="comment">// 2x2 subpixel cols </span></div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s&lt;samps; s++) &#123;</div><div class="line">                        <span class="keyword">double</span> r1 = <span class="number">2</span> * erand48(Xi), dx = r1&lt;<span class="number">1</span> ? <span class="built_in">sqrt</span>(r1) - <span class="number">1</span> : <span class="number">1</span> - <span class="built_in">sqrt</span>(<span class="number">2</span> - r1);</div><div class="line">                        <span class="keyword">double</span> r2 = <span class="number">2</span> * erand48(Xi), dy = r2&lt;<span class="number">1</span> ? <span class="built_in">sqrt</span>(r2) - <span class="number">1</span> : <span class="number">1</span> - <span class="built_in">sqrt</span>(<span class="number">2</span> - r2);</div><div class="line">                        Vec d = cx*(((sx + <span class="number">.5</span> + dx) / <span class="number">2</span> + x) / w - <span class="number">.5</span>) +</div><div class="line">                            cy*(((sy + <span class="number">.5</span> + dy) / <span class="number">2</span> + y) / h - <span class="number">.5</span>) + cam.d;</div><div class="line">                        r = r + radiance(Ray(cam.o + d * <span class="number">140</span>, d.norm()), <span class="number">0</span>, Xi)*(<span class="number">1.</span> / samps);</div><div class="line">                    &#125; <span class="comment">// Camera rays are pushed ^^^^^ forward to start in interior </span></div><div class="line">                    c[i] = c[i] + Vec(clamp(r.x), clamp(r.y), clamp(r.z))*<span class="number">.25</span>;</div><div class="line">                &#125;</div><div class="line">    &#125;</div><div class="line">    FILE *f = fopen(<span class="string">"image.ppm"</span>, <span class="string">"w"</span>);         <span class="comment">// Write image to PPM file. </span></div><div class="line">    <span class="built_in">fprintf</span>(f, <span class="string">"P3\n%d %d\n%d\n"</span>, w, h, <span class="number">255</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;w*h; i++)</div><div class="line">        <span class="built_in">fprintf</span>(f, <span class="string">"%d %d %d "</span>, toInt(c[i].x), toInt(c[i].y), toInt(c[i].z));</div></pre></td></tr></table></figure></p>
<h3 id="2-4光线跟踪递归函数"><a href="#2-4光线跟踪递归函数" class="headerlink" title="2.4光线跟踪递归函数"></a>2.4光线跟踪递归函数</h3><p>radiance函数在第二部分介绍。<br>以下是大致的分块。</p>
<p>1)判断是否相交，求交点，求表面法向<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function">Vec <span class="title">radiance</span><span class="params">(<span class="keyword">const</span> Ray &amp;r, <span class="keyword">int</span> depth, <span class="keyword">unsigned</span> <span class="keyword">short</span> *Xi)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> t;                               <span class="comment">// distance to intersection </span></div><div class="line">    <span class="keyword">int</span> id = <span class="number">0</span>;                               <span class="comment">// id of intersected object </span></div><div class="line">    <span class="keyword">if</span> (!intersect(r, t, id)) </div><div class="line">        <span class="keyword">return</span> Vec(); <span class="comment">// if miss, return black </span></div><div class="line">    <span class="keyword">const</span> Sphere &amp;obj = spheres[id];        <span class="comment">// the hit object </span></div><div class="line">    Vec x = r.o + r.d*t, n = (x - obj.position).norm();    <span class="comment">// calculate vector n,球面法向量</span></div><div class="line">    Vec nl = n.dot(r.d) &lt; <span class="number">0</span> ? n : n*<span class="number">-1</span>, f = obj.color;</div><div class="line">    <span class="keyword">double</span> p = f.x&gt;f.y &amp;&amp; f.x&gt;f.z ? f.x : f.y&gt;f.z ? f.y : f.z; <span class="comment">// max refl </span></div><div class="line">    <span class="keyword">if</span> (++depth&gt;<span class="number">5</span>||!p) </div><div class="line">        <span class="keyword">if</span> (erand48(Xi)&lt;p) </div><div class="line">            f = f*(<span class="number">1</span> / p); </div><div class="line">        <span class="keyword">else</span>  </div><div class="line">            <span class="keyword">return</span> obj.emission;</div></pre></td></tr></table></figure></p>
<p>2）漫反射（DIFF）<br>如果材质是漫反射，那么就随机生成一个方向进行漫反射。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (obj.refl == DIFF) &#123;                  <span class="comment">// Ideal DIFFUSE reflection </span></div><div class="line">    <span class="keyword">double</span> r1 = <span class="number">2</span> * M_PI*erand48(Xi), r2 = erand48(Xi), r2s = <span class="built_in">sqrt</span>(r2);</div><div class="line">    Vec w = nl, u = ((<span class="built_in">fabs</span>(w.x)&gt;<span class="number">.1</span> ? Vec(<span class="number">0</span>, <span class="number">1</span>) : Vec(<span class="number">1</span>)).cross(w)).norm(), v = w.cross(u);    <span class="comment">//w，v，u为正交基</span></div><div class="line">    Vec d = (u*<span class="built_in">cos</span>(r1)*r2s + v*<span class="built_in">sin</span>(r1)*r2s + w*<span class="built_in">sqrt</span>(<span class="number">1</span> - r2)).norm();</div><div class="line">    <span class="keyword">return</span> obj.emission + f.mult(radiance(Ray(x, d), depth, Xi));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3）镜面反射（材质为SPEC）<br>计算镜面反射的方向，然后继续递归<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (obj.refl == SPEC)            <span class="comment">// Ideal SPECULAR reflection </span></div><div class="line">        <span class="keyword">return</span> obj.emission + f.mult(radiance(Ray(x, r.d - n * <span class="number">2</span> * n.dot(r.d)), depth, Xi));</div></pre></td></tr></table></figure></p>
<p>4）反射和折射（材质为REFR）<br>玻璃材质，有一部分光进行反射，有一部分光进行折射。<br>这里用到了轮盘赌方法。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Ray reflRay(x, r.d - n * 2 * n.dot(r.d));     // Ideal dielectric REFRACTION 由平行四边形的方法求得反射光的direction</div><div class="line">    bool into = n.dot(nl)&gt;0;                // Ray from outside going in? </div><div class="line">    double nc = 1, nt = 1.5, nnt = into ? nc / nt : nt / nc, ddn = r.d.dot(nl), cos2t;</div><div class="line">    if ((cos2t = 1 - nnt*nnt*(1 - ddn*ddn))&lt;0)    // Total internal reflection </div><div class="line">        return obj.emission + f.mult(radiance(reflRay, depth, Xi));</div><div class="line">    Vec tdir = (r.d*nnt - n*((into ? 1 : -1)*(ddn*nnt + sqrt(cos2t)))).norm();</div><div class="line">    double a = nt - nc, b = nt + nc, R0 = a*a / (b*b), c = 1 - (into ? -ddn : tdir.dot(n));</div><div class="line">    double Re = R0 + (1 - R0)*c*c*c*c*c, Tr = 1 - Re, P = .25 + .5*Re, RP = Re / P, TP = Tr / (1 - P);</div><div class="line">    return obj.emission + f.mult(depth&gt;2 ? (erand48(Xi)&lt;P ?   // Russian roulette </div><div class="line">        radiance(reflRay, depth, Xi)*RP : radiance(Ray(x, tdir), depth, Xi)*TP) :</div><div class="line">        radiance(reflRay, depth, Xi)*Re + radiance(Ray(x, tdir), depth, Xi)*Tr);</div></pre></td></tr></table></figure></p>
<hr>
<p>参考链接：<br>[1]<a href="https://drive.google.com/file/d/0B8g97JkuSSBwUENiWTJXeGtTOHFmSm51UC01YWtCZw/view" target="_blank" rel="external">https://drive.google.com/file/d/0B8g97JkuSSBwUENiWTJXeGtTOHFmSm51UC01YWtCZw/view</a></p>
<p>[2]<a href="http://www.kevinbeason.com/smallpt/#moreinfo" target="_blank" rel="external">http://www.kevinbeason.com/smallpt/#moreinfo</a></p>

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        <div class="post-footer-tags">
            
            </br>
            <span id="busuanzi_container_page_pv" class="text-color-light text-small">
            Viewd <span id="busuanzi_value_page_pv"></span> times
            </span>
        </div>
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/04/22/raytracing2/"  data-tooltip="smallpt详解(二)">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/03/20/hello-world/" data-tooltip="Hello World">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
            
                <div id="container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  owner: 'FattyMelon',
  repo: 'FattyMelon.github.io',
  oauth: {
    client_id: 'ae5e1fbec7bfdd022624',
    client_secret: '20d776f046a5cfca506202f4f5116d7d1c041942',
  },
})
gitment.render('container')
</script>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 Simon chen. All Rights Reserved.
    </span>

    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/04/22/raytracing2/"  data-tooltip="smallpt详解(二)">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/03/20/hello-world/" data-tooltip="Hello World">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-twitter"></i><span>Share on Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https://fattymelon.github.io/2017/04/20/raytracing1/">
                    <i class="fa fa-google-plus"></i><span>Share on Google+</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/me.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Simon chen</h4>
        
            <div id="about-card-bio"><p>Good good study, day day up.  :D </p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>NetEase Game</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Hangzhou
            </div>
        
    </div>
</div>

        <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-close"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://fattymelon.github.io/2017/03/20/hello-world/">
                            <h3 class="media-heading">Hello World</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Mar 20, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://fattymelon.github.io/2017/04/20/raytracing1/">
                            <h3 class="media-heading">smallpt详解(一)</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 20, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>本文主要是为了记录我学习smallpt的过程。第一部分是关于整个程序的大致分解。第二部分主要说一下我对main函数中cx和cy的理解。第三部分主要说明光线跟踪的每一行代码所用到的数学知识。<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://fattymelon.github.io/2017/04/22/raytracing2/">
                            <h3 class="media-heading">smallpt详解(二)</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 22, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>本文主要说一下自己的理解，<br>关于smallpt的cx,cy是怎么来的，是用来做什么的？<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://fattymelon.github.io/2017/04/25/raytracing3/">
                            <h3 class="media-heading">smallpt详解(三)</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 25, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>本文主要对smallpt的光线跟踪函数进行详细的解释<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://fattymelon.github.io/2017/05/24/hexo_access/">
                            <h3 class="media-heading">Hexo接入Gitment评论</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    May 24, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>做好博客之后想添加评论功能。第三方评论有多说，disqus，网易云跟帖等，但是多说即将关闭，disqus好不容易弄好，老是加载不出来，网易嘛，他申请的时候域名github.io已经被占用就不行了。所以就接入了国内大神做的<a href="https://github.com/imsun/gitment" target="_blank" rel="external">Gitment</a></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                5 posts found
            </p>
        </div>
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-ivwiy10zeb8fifc4swnhkwneuk64y53w2scmdmtp8thi9cqfxh31aowtroaz.min.js"></script>
<!--SCRIPTS END-->

    


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('DHHFWX5CZY', '6ce750764d585dc1fd8b4ff7a8c0130a');
        var algoliaIndex = algoliaClient.initIndex('_post');
    </script>

    </body>
</html>
